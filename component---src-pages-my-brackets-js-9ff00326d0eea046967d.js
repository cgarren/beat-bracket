"use strict";(self.webpackChunkbeatbracket=self.webpackChunkbeatbracket||[]).push([[222],{6998:function(e,t,n){n.r(t),n.d(t,{Head:function(){return L},default:function(){return D}});var a=n(7294),r=n(4442),l=n(8159),o=n(4661);var i=e=>{let{children:t,image:n,imageAlt:r,cardText:i,onClick:s=(()=>{}),removeFunc:c=null}=e;return a.createElement("div",{className:"relative"},c&&n?a.createElement(o.Z,{removeFunc:c}):null,a.createElement("button",{className:"text-center p-3",onClick:s,disabled:!n},a.createElement("div",{className:"rounded-lg w-[320px] h-[320px]"},n?a.createElement("img",{src:n,className:"w-[320px] h-[320px]",width:"320px",height:"320px",alt:r||"Bracket image"}):a.createElement(l.Z,{loadingText:"",hidden:!1})),t,a.createElement("div",{className:"w-[320px]"},i)))};function s(e){let{bracket:t}=e;return a.createElement("div",{className:"inline-flex gap-0.5"},a.createElement("span",null,t.artistName?t.artistName+" ("+t.tracks+" tracks)":"Getting brackets..."),t.winner||t.completed?a.createElement("span",{title:"Completed",className:"text-green-600 text-xs font-medium inline-flex items-center px-0.5 py-0.5 rounded-md"},a.createElement("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"}))):a.createElement("div",null))}var c=n(2618),m=n(5253),d=n(7066);var u=e=>{let{bracket:t,userId:n}=e;const{0:r,1:l}=(0,a.useState)(null);return a.useEffect((()=>{t.artistId&&async function(){const e="https://api.spotify.com/v1/artists/"+t.artistId,n=await(0,d.g7)(e);if(1===n)return null;return n.images[0].url}().then((e=>{l(e)}))}),[t]),a.createElement(i,{image:r,imageAlt:"Picture of "+t.artistName,cardText:t.artistId?a.createElement(s,{bracket:t}):"Loading...",removeFunc:async function(){window.confirm("Are you sure you want to permanently delete this "+t.artistName+" bracket?")&&(console.log("removing bracket"),0===await(0,m.nl)(t.id,n)&&window.location.reload())},onClick:()=>{(0,c.ig)(t.id,n)}})},p=n(4184),f=n.n(p);var g=e=>{let{text:t,activeTab:n,id:r,setActiveTab:l}=e;return a.createElement("button",{title:t+" tab",className:f()("py-4 px-6 block bg-transparent hover:bg-transparent hover:text-blue-700 hover:border-blue-700 focus:outline-none border-b-2 border-x-0 border-t-0 rounded-none font-medium",{"text-blue-700 border-blue-700":n===r},{"text-gray-600 border-transparent":n!==r}),onClick:()=>l(r)},t)},b=n.p+"static/createBracket-0d50326bd56d099bd40ebec3b048bc52.png";var h={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let v;const E=new Uint8Array(16);function w(){if(!v&&(v="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!v))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return v(E)}const y=[];for(let P=0;P<256;++P)y.push((P+256).toString(16).slice(1));function x(e,t=0){return(y[e[t+0]]+y[e[t+1]]+y[e[t+2]]+y[e[t+3]]+"-"+y[e[t+4]]+y[e[t+5]]+"-"+y[e[t+6]]+y[e[t+7]]+"-"+y[e[t+8]]+y[e[t+9]]+"-"+y[e[t+10]]+y[e[t+11]]+y[e[t+12]]+y[e[t+13]]+y[e[t+14]]+y[e[t+15]]).toLowerCase()}var k=function(e,t,n){if(h.randomUUID&&!t&&!e)return h.randomUUID();const a=(e=e||{}).random||(e.rng||w)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=a[e];return t}return x(a)},I=n(4015);var C=e=>{let{setArtist:t,disabled:n}=e;const{0:r,1:l}=(0,a.useState)(""),{0:o,1:i}=(0,a.useState)([]);return(0,a.useEffect)((()=>{!async function(){if(""!==r.trim()){var e="https://api.spotify.com/v1/search/?"+new URLSearchParams({q:r,type:"artist",limit:5}).toString();let n=await(0,d.g7)(e);if(1!==n&&n.artists.items.length>0){let e=[];n.artists.items.forEach((n=>{n.images.length>0&&e.push({name:n.name,art:n.images[2].url,id:n.id,onClick:()=>{t({name:n.name,id:n.id,art:n.images[2].url}),l("")}})})),i(e)}else i([])}else i([])}()}),[r]),(0,a.useEffect)((()=>{document.getElementById("searchbar").addEventListener("keydown",(e=>{"ArrowDown"===e.key&&(e.preventDefault(),document.getElementById("artist-list").children.length>0&&document.getElementById("artist-list").firstChild.focus())})),document.getElementById("artist-list").addEventListener("keydown",(e=>{document.getElementById("artist-list").children.length>0&&("ArrowUp"===e.key?(e.preventDefault(),e.stopPropagation(),document.activeElement===document.getElementById("artist-list").firstChild?document.getElementById("searchbar").focus():document.getElementById("artist-list").contains(document.activeElement)&&document.activeElement.previousSibling.focus()):"ArrowDown"===e.key&&(e.preventDefault(),e.stopPropagation(),document.getElementById("artist-list").contains(document.activeElement)&&document.activeElement.nextSibling&&document.activeElement.nextSibling.focus()))}))}),[]),a.createElement("div",{className:"inline-flex flex-col justify-items-center mb-2 place-items-center border-black border-0 rounded-md "},a.createElement("input",{placeholder:"Search for an artist...","aria-label":"Search for an artist...",size:"search",id:"searchbar",type:"search",spellCheck:!1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",autoFocus:!0,value:r,onChange:e=>l(e.target.value),className:"text-black text-2xl font-bar w-full p-1 border-2 border-gray-500 rounded focus:z-10 pl-3 mousetrap focus-visible:outline-none focus-visible:border-blue-500 focus-visible:border-1",disabled:n}),a.createElement("div",{id:"artist-list",className:"m-0 p-0 list-none flex-nowrap gap-0 inline-flex flex-col text-center w-full rounded"},o.map((e=>a.createElement(I.Z,{artistName:e.name,art:e.art,onClick:e.onClick,key:e.id})))))},N=n(243);var S=e=>{let{userId:t}=e;const{0:n,1:r}=(0,a.useState)(!1);return a.createElement("div",null,a.createElement(i,{image:b,imageAlt:"Plus sign",cardText:"Create Bracket",onClick:()=>{r(!0)}}),n?a.createElement(N.Z,{onClose:()=>r(!1)},a.createElement(C,{setArtist:function(e){if(e){const n=k();console.log("Create New Bracket with id: "+n),(0,c.ig)(n,t,{artist:e})}}})):null)},B=n(8711),T=n(4657),A=n(1883),U=n(7825);var D=e=>{let{location:t}=e;const n=(0,m.hZ)(),{0:l,1:o}=(0,a.useState)([{id:1,userId:void 0,artistName:void 0,artistId:void 0,tracks:void 0,completed:!1}]),{0:i,1:s}=(0,a.useState)(0),c=(0,T.n5)(),{0:d,1:p}=(0,a.useState)({show:!1,message:null,type:null,timeoutId:null}),{0:f,1:b}=(0,a.useState)(!1),h=(0,a.useMemo)((()=>(console.log(l),l.filter((e=>0===i||(1===i?!e.completed&&!e.winner:2!==i||(e.completed||e.winner)))))),[i,l]);function v(e,t,n){void 0===t&&(t="info"),void 0===n&&(n=!0),d.timeoutId&&clearTimeout(d.timeoutId);let a=null;n&&(a=setTimeout((()=>{p({show:!1,message:null,type:null,timeoutId:null})}),5e3)),p({show:!0,message:e,type:t,timeoutId:a})}return(0,a.useEffect)((()=>window.scrollTo(0,0)),[]),(0,a.useEffect)((()=>{(async function(){const e=new URLSearchParams(window.location.search);window.history.replaceState({},document.title,window.location.pathname);try{await(0,T.IS)(e)}catch(t){return console.log("Error authenticating:",t),b(!0),void v("Error authenticating","error",!1)}})().then((()=>{(0,T.jl)()?(0,m.fe)().then((e=>{1!==e?(console.log(e),o(e)):(console.log("Error loading brackets"),v("Error loading brackets, try logging in again","error",!1),b(!0))})):(0,A.navigate)("/")}))}),[]),a.createElement(r.Z,{noChanges:()=>!0,path:t.pathname},a.createElement(B.Z,{show:d.show,close:function(){d.timeoutId&&clearTimeout(d.timeoutId),p({show:!1,message:null,type:null,timeoutId:null})},message:d.message,type:d.type}),a.createElement("div",{className:"text-center",hidden:f},a.createElement("h1",{className:"text-4xl font-extrabold font-display"},"My Brackets"),c&&n?a.createElement("p",{className:"text-sm text-gray-600 mb-2"},l.length+"/"+n+" brackets used"):null,a.createElement("div",{className:""},a.createElement("nav",{className:"inline-flex flex-row"},a.createElement(g,{id:0,activeTab:i,setActiveTab:s,text:"All"}),a.createElement(g,{id:1,activeTab:i,setActiveTab:s,text:"In Progess"}),a.createElement(g,{id:2,activeTab:i,setActiveTab:s,text:"Completed"}))),a.createElement("div",{className:"pt-3 flex flex-row flex-wrap justify-center items-stretch gap-5 sm:mx-5"},0===i&&n&&l.length<n&&c?a.createElement(S,{userId:c}):null,h.map((e=>a.createElement(u,{bracket:e,key:e.id,userId:c}))))))};function L(){return a.createElement(U.p,{title:"Beat Bracket - My brackets"})}}}]);
//# sourceMappingURL=component---src-pages-my-brackets-js-9ff00326d0eea046967d.js.map